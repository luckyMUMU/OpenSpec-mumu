# SOP 文档审查指南

> **版本**: v1.5.0  
> **更新日期**: 2026-02-11  
> **用途**: SOP文档系统性审查标准与版本管理规范

---

## 1. 版本管理规则

### 1.1 版本格式

SOP文档采用 **语义化版本控制** 格式：

```
v[主版本].[次版本].[修订版本]
```

### 1.2 版本定义

| 版本类型 | 命名 | 更新规则 | 影响范围 |
|----------|------|----------|----------|
| **主版本** | v1.x.x | 架构级变更、新增核心流程、新增角色 | 全局统一 |
| **次版本** | vx.1.x | 新增功能、新增路径、新增约束 | 全局统一 |
| **修订版本** | vx.x.1 | 文档修正、错别字、格式调整 | 可差异化 |

### 1.3 全局统一规则

**必须全局统一的版本号**：
- ✅ 主版本号（第1位）- 所有文档必须一致
- ✅ 次版本号（第2位）- 所有文档必须一致

**允许差异化的版本号**：
- ✅ 修订版本号（第3位）- 各子文档可独立递增

### 1.4 版本更新触发条件

#### 主版本更新（v1→v2）

触发条件（满足任一）：
- 新增核心AI角色
- 新增工作流路径（如快速/深度/TDD之外的新路径）
- 文档层级架构变更（L1-L4调整）
- 验收机制根本性变更

#### 次版本更新（v1.1→v1.2）

触发条件（满足任一）：
- 新增功能模块（如分层验收）
- 新增约束类型（如黑白名单）
- 新增文档模板
- 流程优化（非架构级）

#### 修订版本更新（v1.1.0→v1.1.1）

触发条件（满足任一）：
- 错别字修正
- 格式调整
- 链接修复
- 描述优化（不改变含义）

### 1.5 版本更新流程

```
步骤1: 确定更新类型
  ├─ 架构变更？→ 主版本+1，次版本=0，修订=0
  ├─ 功能新增？→ 次版本+1，修订=0
  └─ 文档修正？→ 仅修订版本+1

步骤2: 全局更新（主/次版本变更时）
  ├─ 更新所有文档的版本号
  ├─ 更新CHANGELOG.md
  └─ 更新Skill文件版本号

步骤3: 局部更新（仅修订版本变更时）
  └─ 仅更新当前文档的版本号

步骤4: 验证
  ├─ 检查主版本一致性
  ├─ 检查次版本一致性
  └─ 更新修订版本记录
```

### 1.6 版本一致性检查清单

- [ ] 所有核心文档主版本一致
- [ ] 所有核心文档次版本一致
- [ ] CHANGELOG版本与文档版本一致
- [ ] Skill文件版本与SOP版本一致
- [ ] 文档内版本号与页眉版本号一致

---

## 2. 审查目标

确保 SOP 文档满足以下要求：

1. **流程完整性**: 所有流程完整、无遗漏
2. **逻辑正确性**: 流程逻辑正确、角色职责清晰
3. **文档一致性**: AGENT版本与人类版本一致
4. **表达简洁性**: AGENT版本使用最少token表达
5. **表达可执行性**: 使用准确无歧义的命令式表达（条件→动作→输出/落盘）

---

## 3. 审查维度

### 3.1 一致性审查

#### AGENT版本 vs 人类版本对比

| 检查项 | AGENT版本 | 人类版本 | 检查方法 |
|--------|-----------|----------|----------|
| **角色定义** | AGENT_SOP.md 角色表 | sop_for_human.md 第2章 | 逐角色对比 |
| **流程描述** | AGENT_SOP.md 工作流 | sop_for_human.md 第4章 | 逐路径对比 |
| **停止点** | AGENT_SOP.md 停止点 | sop_for_human.md 停止点 | 列表对比 |
| **约束定义** | 05_constraints/ | sop_for_human.md 第14章 | 内容对比 |
| **验收机制** | 05_constraints/acceptance_criteria.md | sop_for_human.md 第15章 | 层级对比 |

#### 术语一致性检查清单

- [ ] L1/L2/L3/L4 定义一致
- [ ] 角色名称集合一致（以角色矩阵为准）
- [ ] 停止点标记一致
- [ ] 来源与依赖合规术语一致（source/dependency/decision record），并引用唯一来源（SSOT）
- [ ] 文件路径格式一致
- [ ] 版本号一致

### 3.2 完整性审查

#### 文档完整性检查清单

| 文档类型 | 必需文件 | 检查项 |
|----------|----------|--------|
| **核心文档** | AGENT_SOP.md | 角色、流程、约束完整 |
| **人类文档** | sop_for_human.md | 所有章节完整 |
| **角色文档** | 02_role_matrix/index.md | 角色定义完整（数量以表格为准） |
| **工作流文档** | 03_workflow/*.md | 路径定义完整（以索引为准） |
| **约束文档** | 05_constraints/*.md | 禁止项/验收标准完整 |
| **角色指令** | prompts/*.md | 覆盖所有角色（与角色矩阵一致） |

#### 流程完整性检查清单

- [ ] 每条路径的阶段顺序完整（以工作流文档为准）
- [ ] 分支与回路完整（审查/返工/僵局/用户决策等）
- [ ] 所有停止点定义
- [ ] 三错规则定义
- [ ] 文档同步规则

### 3.3 正确性审查

#### 逻辑正确性检查清单

- [ ] 流程顺序正确（不能跳过阶段）
- [ ] 角色切换逻辑正确
- [ ] 停止点触发条件正确
- [ ] 约束定义合理可执行
- [ ] 验收层级逻辑正确（L1→L2→L3→L4）
- [ ] 来源与依赖缺口必须中断：进入 `[USER_DECISION]`，并落盘决策记录；后续产物必须引用该记录

#### 交叉引用正确性检查清单

- [ ] 所有内部链接有效
- [ ] 引用的文档存在
- [ ] 版本号引用正确
- [ ] 文件路径引用正确

### 3.4 简洁性审查

#### AGENT版本简洁性标准

AGENT版本应使用**最少token**表达关键信息：

| 优化项 | 优化前 | 优化后 | 节省token |
|--------|--------|--------|-----------|
| **表格替代段落** | 长文本描述 | 表格 | 50-70% |
| **列表替代段落** | 长段落 | 有序/无序列表 | 30-50% |
| **代码块替代描述** | 流程描述 | ASCII流程图 | 40-60% |
| **缩写和符号** | 完整句子 | 符号和缩写 | 20-30% |

#### 简洁性检查清单

- [ ] 使用表格替代长段落
- [ ] 使用列表替代描述性文字
- [ ] 关键信息突出（加粗、高亮）
- [ ] 删除冗余描述
- [ ] 使用标准缩写

### 3.5 表达规范审查（命令式）

SOP流程/规则必须使用可验证的命令式表达，推荐结构：

```
仅当/当…时 → 必须/禁止/仅能 → 输出（交付物/路径）
```

#### 表达规范检查清单

- [ ] 规则使用“必须/禁止/仅当/否则”表达，不使用“建议/尽量/可能/一般/视情况”等
- [ ] 规则同时包含触发条件、动作、输出（交付物与路径）
- [ ] 状态/命令的名称引用有唯一来源（SSOT）：05_constraints/state_dictionary.md、05_constraints/command_dictionary.md

### 3.6 Skill合规性审查（对齐SOP流程设计）

Skill文件必须体现SOP流程的可执行闭环：输入明确、步骤可执行、停止点可触发、产物可落盘。

#### Skill合规性检查清单

- [ ] Skill描述以命令式步骤为主（可映射到命令字典）
- [ ] Skill定义包含：适用条件、输入、输出、停止点、失败处理、持久化交付物
- [ ] Skill引用的状态/停止点/命令与SSOT一致
- [ ] Skill/Prompt 若要求产出设计/审查/测试资产，必须要求“来源与依赖声明”或引用 `04_reference/review_standards/source_dependency.standard.md`

---


## 4. 审查流程

### 4.1 审查步骤

```
步骤1: 读取核心文档
  ├─ 读取 AGENT_SOP.md
  ├─ 读取 sop_for_human.md
  └─ 读取 ROLE_CHEATSHEET.md

步骤2: 对比审查
  ├─ 对比角色定义
  ├─ 对比流程描述
  ├─ 对比停止点
  └─ 对比约束定义

步骤3: 详细检查
  ├─ 检查工作流文档
  ├─ 检查约束文档
  ├─ 检查角色指令
  └─ 检查交叉引用

步骤4: 生成报告
  ├─ 列出不一致项
  ├─ 列出冗余内容
  ├─ 提出修复建议
  └─ 优先级排序
```

### 4.2 交付物（Artifacts）规范

每个阶段结束必须产出**可持久化交付物**（文件落盘），供后续阶段复用与审计；禁止仅存在于对话上下文。

**固定目录模板**：

```
sop/reviews/YYYY-MM-DD/
```

| 阶段 | 必须交付物 | 目的 |
|------|------------|------|
| 步骤1 读取核心文档 | `00_scope.md` | 固定审查范围与版本基线 |
| 步骤2 对比审查 | `01_diff_matrix.md` | 固化AGENT vs 人类差异矩阵 |
| 步骤3 详细检查 | `02_issue_list.md`、`03_link_check.md`、`04_version_check.md` | 固化问题、链接、版本核对结果 |
| 步骤4 生成报告 | `05_review_report.md` | 固化审查结论与修复建议 |

### 4.3 审查工具

| 工具 | 用途 | 命令 |
|------|------|------|
| **文本对比** | 对比两个文档 | diff 或 IDE对比 |
| **链接检查** | 检查链接有效性 | 手动点击或脚本 |
| **字数统计** | 检查简洁性 | wc -c 或 IDE统计 |

---

## 5. 常见问题及修复

### 5.1 一致性问题

#### 问题1: 角色职责不一致

**症状**: AGENT版本和人类版本描述不同

**修复**: 
1. 以人类版本为准（更详细）
2. AGENT版本简化为表格形式
3. 确保核心信息一致

#### 问题2: 停止点不一致

**症状**: 停止点名称或触发条件不同

**修复**:
1. 统一停止点命名
2. 统一触发条件描述
3. 在所有文档中同步更新

#### 问题3: 版本号不一致

**症状**: 文档版本号与CHANGELOG不一致

**修复**:
1. 以CHANGELOG为准
2. 批量更新所有文档版本号
3. 更新版本日期

### 5.2 完整性问题

#### 问题1: 缺少新功能描述

**症状**: 新增功能（如分层验收）未在所有文档中描述

**修复**:
1. 在AGENT_SOP.md中添加
2. 在sop_for_human.md中添加
3. 在ROLE_CHEATSHEET.md中添加

#### 问题2: 流程图不完整

**症状**: ASCII流程图缺少新步骤

**修复**:
1. 更新流程图
2. 确保所有分支完整
3. 添加新停止点

### 5.3 简洁性问题

#### 问题1: 描述过于冗长

**症状**: 段落过长，关键信息不突出

**修复**:
1. 转换为表格
2. 使用列表
3. 删除冗余描述

#### 问题2: 重复定义

**症状**: 同一概念在多处定义

**修复**:
1. 保留一处详细定义
2. 其他处使用链接引用
3. 使用摘要形式

---

## 6. 审查检查表

### 6.1 核心文档审查检查表

#### AGENT_SOP.md

- [ ] 版本号正确
- [ ] 核心约束完整（5条）
- [ ] 路径选择正确
- [ ] 角色表完整（以角色矩阵为准）
- [ ] 工作流描述正确
- [ ] 三错规则正确
- [ ] 文档位置正确
- [ ] 需求分层正确
- [ ] design.md规则正确
- [ ] TDD规则正确
- [ ] 版本号管理正确
- [ ] 导航链接有效

#### sop_for_human.md

- [ ] 版本号与AGENT_SOP.md一致
- [ ] 第1章（概述）完整
- [ ] 第2章（角色）与AGENT一致
- [ ] 第3章（路径）完整
- [ ] 第4章（工作流）与AGENT一致
- [ ] 第5章（停止点）完整
- [ ] 第6章（文档规范）完整
- [ ] 第7章（L1-L3需求）完整
- [ ] 第8章（L2架构）完整
- [ ] 第9章（L3实现）完整
- [ ] 第10章（TDD）完整
- [ ] 第11章（质量）完整
- [ ] 第12章（问题处理）完整
- [ ] 第13章（最佳实践）完整
- [ ] 第14章（禁止项）完整
- [ ] 第15章（分层验收）完整

#### ROLE_CHEATSHEET.md

- [ ] 版本号一致
- [ ] 角色索引完整
- [ ] 路径速查完整
- [ ] 文档类型速查完整
- [ ] 三错规则速查完整
- [ ] 版本号速查完整
- [ ] 禁止项速查完整
- [ ] 分层验收速查完整

### 6.2 工作流文档审查检查表

#### 03_workflow/index.md

- [ ] 快速路径定义
- [ ] 深度路径定义
- [ ] TDD路径定义
- [ ] 分层验收路径定义
- [ ] 路径选择条件

#### 03_workflow/fast_path.md

- [ ] 适用条件
- [ ] 流程步骤
- [ ] 停止点
- [ ] 约束

#### 03_workflow/deep_path.md

- [ ] 标准深度路径
- [ ] 分层验收深度路径
- [ ] 步骤表格
- [ ] 验收流程
- [ ] 审查循环
- [ ] 约束

### 6.3 约束文档审查检查表

#### 05_constraints/constraint_matrix.md

- [ ] 全局禁止项
- [ ] 角色特定禁止项（覆盖所有角色）
- [ ] 阶段特定禁止项
- [ ] 文件类型禁止项
- [ ] 路径特定禁止项
- [ ] 违反后果等级

#### 05_constraints/acceptance_criteria.md

- [ ] 验收角色分工
- [ ] L1验收标准
- [ ] L2验收标准
- [ ] L3验收标准
- [ ] L4验收标准
- [ ] 测试充分性检查
- [ ] 停止点定义
- [ ] 失败处理流程

### 6.4 表达与Skill审查检查表

#### 表达可执行性（命令式）

- [ ] 每条规则满足：条件（仅当/当…时）→动作（必须/禁止/仅能）→输出（交付物/路径）
- [ ] 禁止使用暧昧词：建议、尽量、可能、一般、视情况、适当、差不多
- [ ] 术语/状态/命令引用有唯一来源（SSOT），且与引用处一致

#### Skill文件（sop/skills/*/SKILL.md）

- [ ] 版本号主/次版本与SOP一致
- [ ] Skill定义包含：适用条件、输入、输出、停止点、失败处理、持久化交付物
- [ ] Skill中的命令/状态引用对齐SSOT（state_dictionary / command_dictionary）

---

## 7. 模板库

```markdown
# SOP文档审查报告

## 审查信息
- **审查日期**: YYYY-MM-DD
- **审查人**: [姓名]
- **审查范围**: [文档列表]

## 发现的问题

### 高优先级

| 问题 | 位置 | 描述 | 建议修复 |
|------|------|------|----------|
| 1 | [文件] | [描述] | [建议] |

### 中优先级

| 问题 | 位置 | 描述 | 建议修复 |
|------|------|------|----------|
| 1 | [文件] | [描述] | [建议] |

### 低优先级

| 问题 | 位置 | 描述 | 建议修复 |
|------|------|------|----------|
| 1 | [文件] | [描述] | [建议] |

## 修复计划

1. **高优先级** (立即修复)
   - [ ] 问题1
   - [ ] 问题2

2. **中优先级** (本周修复)
   - [ ] 问题3
   - [ ] 问题4

3. **低优先级** (下次迭代)
   - [ ] 问题5
   - [ ] 问题6

## 审查结论

- [ ] 通过 - 无重大问题
- [ ] 有条件通过 - 需修复中优先级问题
- [ ] 不通过 - 需修复高优先级问题
```

---

### 7.1 决策记录模板（Decision Record）

当触发 `[USER_DECISION]` 且原因是“来源/依赖缺口”时，必须创建决策记录文件并在后续产物引用。

推荐落盘目录：`docs/04_context_reference/decisions/`

```markdown
# 决策记录（Decision Record）

## 元信息
- **日期**: YYYY-MM-DD
- **主题**: SOURCE_MISSING / DEPENDENCY_MISSING / CONFLICT
- **触发状态**: [USER_DECISION]

## 缺口描述
- 缺少的来源/依赖: ...
- 影响: ...

## 选项
- A: ...
- B: ...
- C: ...

## 用户选择
- 选择: A/B/C/自定义
- 理由: ...

## 后续引用
- 必须在后续产物中引用本文件路径
```

### 7.2 差异矩阵模板（AGENT vs 人类）

```markdown
# 差异矩阵（AGENT vs 人类）

## 元信息
- **日期**: YYYY-MM-DD
- **SOP版本基线**: v<MAJOR>.<MINOR>.<PATCH>
- **对比范围**: [文件列表]

| 主题 | AGENT位置 | 人类位置 | 差异描述（命令式） | 结论（保留/修复/删除） | 交付物 |
|------|----------|----------|--------------------|------------------------|--------|
| 角色 | [file#Lx-Ly] | [file#Lx-Ly] | 必须…；禁止…；仅当… | [ ] | [path] |
```

### 7.3 版本一致性核对模板

```markdown
# 版本一致性核对

## 元信息
- **日期**: YYYY-MM-DD
- **目标主/次版本**: v<MAJOR>.<MINOR>.x

| 文件 | 声明版本 | 是否符合目标主/次版本 | 需要修复（是/否） |
|------|----------|------------------------|-------------------|
| [path] | v<MAJOR>.<MINOR>.<PATCH> | [ ] | [ ] |
```

### 7.4 链接检查结果模板

```markdown
# 链接检查结果

## 元信息
- **日期**: YYYY-MM-DD
- **检查范围**: [文件列表]

| 来源文件 | 链接文本 | 目标 | 结果（OK/FAIL） | 修复动作（命令式） |
|----------|----------|------|------------------|--------------------|
| [path] | [text] | [target] | [ ] | 必须将…更新为… |
```

### 7.5 交付物清单模板（Artifacts Manifest）

```markdown
# 交付物清单（Artifacts Manifest）

## 元信息
- **日期**: YYYY-MM-DD
- **审查目录**: sop/reviews/YYYY-MM-DD/

| 阶段 | 交付物路径 | 生成/更新动作（命令式） | 复用方 |
|------|------------|--------------------------|--------|
| 步骤1 | 00_scope.md | 必须创建并写入审查范围与版本基线 | 步骤2-4 |
| 步骤2 | 01_diff_matrix.md | 必须更新差异矩阵并标注结论 | 步骤3-4 |
| 步骤3 | 02_issue_list.md | 必须更新问题清单并分级 | 步骤4 |
| 步骤3 | 03_link_check.md | 必须记录所有FAIL链接与修复动作 | 步骤4 |
| 步骤3 | 04_version_check.md | 必须记录版本核对结果与修复动作 | 步骤4 |
| 步骤4 | 05_review_report.md | 必须生成审查报告并引用上述交付物 | 后续修复 |
```

## 8. 最佳实践

### 8.1 保持简洁的技巧

1. **使用表格**: 对比信息用表格，节省50%+ token
2. **使用列表**: 步骤说明用列表，清晰且简洁
3. **使用代码块**: 流程图用ASCII，直观且省空间
4. **删除冗余**: 删除"的"、"了"等助词
5. **使用符号**: 用→代替"然后"，用✓代替"正确"

### 8.2 保持一致的技巧

1. **建立术语表**: 统一定义，所有文档引用
2. **使用模板**: 统一格式，减少差异
3. **交叉检查**: 修改一处，检查所有引用
4. **版本同步**: 批量更新版本号

### 8.3 确保完整的技巧

1. **检查清单**: 使用本文档的检查清单
2. **流程验证**: 从头到尾走一遍流程
3. **角色验证**: 确保每个角色有指令
4. **链接验证**: 点击所有链接检查

---

**提示**: 定期使用本指南审查SOP文档，确保文档质量。
