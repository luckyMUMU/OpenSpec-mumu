# æ·±åº¦è·¯å¾„

> **ç‰ˆæœ¬**: v1.5.1

**é€‚ç”¨**: è·¨æ–‡ä»¶/æ–°åŠŸèƒ½/é‡æ„/APIå˜æ›´

---

## æ¥æºä¸ä¾èµ–å‡†åˆ™ï¼ˆå…¨è·¯å¾„é€šç”¨ï¼‰

- Analystï¼šé™¤â€œéœ€æ±‚ä¸»è¦æ¥æºäºç”¨æˆ·â€å¤–ï¼Œå¿…é¡»åœ¨äº§ç‰©ä¸­å£°æ˜è¡¥å……æ¥æºä¸ä¾èµ–
- Prometheus/Oracle/Tester/Worker/TestWorker/CodeReviewerï¼šå¿…é¡»å£°æ˜å…¶è¾“å…¥æ¥æºäºå‰ç½®é˜¶æ®µäº§å‡ºï¼Œå¹¶åˆ—å‡ºä¾èµ–æ¸…å•ï¼ˆæ¨¡æ¿ï¼š`04_reference/interaction_formats/source_dependency.md`ï¼‰
- å½“æ‰¾ä¸åˆ°æ¥æºæˆ–ä¾èµ–æ—¶ï¼šå¿…é¡»è¿›å…¥ `[USER_DECISION]` å¹¶åŒæ—¶è½ç›˜å†³ç­–è®°å½•

## ç›®å½•ç»´åº¦æ·±åº¦è·¯å¾„

### æ ¸å¿ƒæµç¨‹

```
Analyst â†’ Prometheus â†” Skeptic â†’ Oracle â†’ Supervisor â†’ [å¤š Worker å¹¶è¡Œ] â†’ CodeReviewer â†’ Librarian
                                              â†“
                                    æŒ‰ç›®å½•æ·±åº¦è°ƒåº¦ Worker
```

### ç›®å½•å¹¶è¡Œæ‰§è¡Œæµç¨‹

```
1. Explorer æ‰«æç›®å½•ç»“æ„ï¼Œè¯†åˆ«æ‰€æœ‰ design.md
2. Supervisor æŒ‰ç›®å½•æ·±åº¦æ’åºï¼Œåˆ›å»ºç›®å½•-Worker æ˜ å°„è¡¨
3. æŒ‰æ·±åº¦é™åºåˆ†æ‰¹å¯åŠ¨ Workerï¼ˆåŒæ·±åº¦å¹¶è¡Œï¼‰
4. Worker å¤„ç†å½“å‰ç›®å½•ï¼Œé‡åˆ°ä¾èµ–åˆ™æ ‡è®°ç­‰å¾…
5. Supervisor ç›‘æ§è¿›åº¦ï¼Œå”¤é†’ç­‰å¾…ä¾èµ–çš„ Worker
6. Worker å®Œæˆåæäº¤ä»£ç å®¡æŸ¥ï¼ŒCodeReviewer å®¡æŸ¥å¹¶é©±åŠ¨è¿”å·¥å›è·¯
7. æ‰€æœ‰ç›®å½•å®Œæˆä¸”ä»£ç å®¡æŸ¥é€šè¿‡åï¼ŒLibrarian æ›´æ–°æ–‡æ¡£
```

ğŸ‘‰ [ç›®å½•ç»´åº¦å·¥ä½œç­–ç•¥è¯¦æƒ…](../04_reference/design_directory_strategy.md)

---

## æ ‡å‡†æ·±åº¦è·¯å¾„ï¼ˆå•ç›®å½•ï¼‰

### æ–°é¡¹ç›®/å¤§é‡æ„
```
Analyst â†’ Prometheus â†” Skeptic â†’ Oracle â†’ Worker â†’ CodeReviewer â†’ Librarian
```

### åŠŸèƒ½è¿­ä»£
```
Analyst â†’ Oracle â†’ Worker â†’ CodeReviewer â†’ Librarian
```

---

## æ­¥éª¤

### å…¨å±€é˜¶æ®µï¼ˆå…¨å±€æ‰§è¡Œï¼‰

| é˜¶æ®µ | è¾“å…¥ | è¾“å‡º | åœæ­¢ç‚¹ | æ‰§è¡Œè€… |
|------|------|------|--------|--------|
| Analyst | ç”¨æˆ·æè¿° | PRD/MRD/FRD | `[WAITING_FOR_REQUIREMENTS]` | å…¨å±€ |
| Prometheus | PRD | æ¶æ„è®¾è®¡ | `[WAITING_FOR_ARCHITECTURE]` | å…¨å±€ |
| Skeptic | æ¶æ„è®¾è®¡ | å®¡æŸ¥æŠ¥å‘Š | `[ARCHITECTURE_PASSED]` | å…¨å±€ |

### ç›®å½•é˜¶æ®µï¼ˆæŒ‰ç›®å½•å¹¶è¡Œæ‰§è¡Œï¼‰

| é˜¶æ®µ | è¾“å…¥ | è¾“å‡º | åœæ­¢ç‚¹ | æ‰§è¡Œè€… |
|------|------|------|--------|--------|
| Oracle | æ¶æ„è®¾è®¡ | å®ç°è®¾è®¡ | `[WAITING_FOR_DESIGN]` | æŒ‰ç›®å½• |
| **Supervisor** | **å®ç°è®¾è®¡** | **ç›®å½•-Worker æ˜ å°„** | **`[SCHEDULING]`** | **å…¨å±€åè°ƒ** |
| **Worker** | **design.md** | **ä»£ç ** | **`[WAITING_FOR_CODE_REVIEW]`** | **design.md æ‰€åœ¨ç›®å½•** |
| CodeReviewer | Diff+è®¾è®¡æ–‡æ¡£ | å®¡æŸ¥æŠ¥å‘Š | Diffå±•ç¤º | å…¨å±€ |
| Librarian | ä»£ç  | æ–‡æ¡£æ›´æ–° | `[å·²å®Œæˆ]` | å…¨å±€ |

### ç›®å½•-Worker æ˜ å°„è¡¨ç¤ºä¾‹
æ¨¡æ¿ï¼š04_reference/interaction_formats/supervisor_report.mdï¼ˆè¿›åº¦æ›´æ–°ä¸­çš„è¡¨æ ¼ï¼‰

CMD: `SCHEDULE_DIRS(design_list) -> dir_map`

---

## åˆ†å±‚éªŒæ”¶æ·±åº¦è·¯å¾„ï¼ˆæ¨èï¼‰

**é€‚ç”¨åœºæ™¯**: æ‰€æœ‰æ·±åº¦è·¯å¾„ä»»åŠ¡ï¼Œå¼ºåˆ¶åˆ†å±‚éªŒæ”¶

### æµç¨‹
```
Analyst â†’ Prometheus â†” Skeptic â†’ Oracle â†’ Tester â†’ TestWorker â†’ Worker â†’ CodeReviewer â†’ Librarian
                                    â†“           â†“           â†“
                              è®¾è®¡æ–‡æ¡£    è®¾è®¡éªŒæ”¶æµ‹è¯•    å®ç°éªŒæ”¶æµ‹è¯•    è¿è¡ŒéªŒæ”¶æµ‹è¯•
```

### æ­¥éª¤

| é˜¶æ®µ | è¾“å…¥ | è¾“å‡º | åœæ­¢ç‚¹ | è¯´æ˜ |
|------|------|------|--------|------|
| Analyst | ç”¨æˆ·æè¿° | PRD/MRD/FRD | `[WAITING_FOR_REQUIREMENTS]` | éœ€æ±‚åˆ†æ |
| Prometheus | PRD | æ¶æ„è®¾è®¡ | `[WAITING_FOR_ARCHITECTURE]` | æ¶æ„è®¾è®¡ |
| Skeptic | æ¶æ„è®¾è®¡ | å®¡æŸ¥æŠ¥å‘Š | `[ARCHITECTURE_PASSED]` | æ¶æ„å®¡æŸ¥ |
| Oracle | æ¶æ„è®¾è®¡ | å®ç°è®¾è®¡ | `[WAITING_FOR_DESIGN]` | å®ç°è®¾è®¡ |
| **Tester** | **å®ç°è®¾è®¡** | **L1-L4æµ‹è¯•è®¾è®¡** | **`[WAITING_FOR_TEST_DESIGN]`** | **è®¾è®¡åˆ†å±‚éªŒæ”¶æµ‹è¯•** |
| **TestWorker** | **æµ‹è¯•è®¾è®¡** | **L1-L4æµ‹è¯•ä»£ç ** | **`[WAITING_FOR_TEST_IMPLEMENTATION]`** | **å®ç°åˆ†å±‚éªŒæ”¶æµ‹è¯•** |
| **Worker** | **å®ç°è®¾è®¡+æµ‹è¯•** | **ä»£ç +éªŒæ”¶** | **è§ä¸‹æ–¹éªŒæ”¶æµç¨‹** | **ç¼–ç +è¿è¡ŒéªŒæ”¶æµ‹è¯•** |
| CodeReviewer | Diff+è®¾è®¡æ–‡æ¡£ | å®¡æŸ¥æŠ¥å‘Š | Diffå±•ç¤º | ä»£ç å®¡æŸ¥ä¸è¿”å·¥å›è·¯ |
| Librarian | ä»£ç +æµ‹è¯• | æ–‡æ¡£æ›´æ–° | `[å·²å®Œæˆ]` | æ–‡æ¡£å½’æ¡£ |

### åˆ†å±‚éªŒæ”¶æµç¨‹ï¼ˆWorkeræ‰§è¡Œï¼‰
CMD: `RUN_ACCEPTANCE(L1) -> [WAITING_FOR_L1_REVIEW] -> REVIEW_ACCEPTANCE(L1)`
CMD: `RUN_ACCEPTANCE(L2) -> [WAITING_FOR_L2_REVIEW] -> REVIEW_ACCEPTANCE(L2)`
CMD: `RUN_ACCEPTANCE(L3) -> [WAITING_FOR_L3_REVIEW] -> REVIEW_ACCEPTANCE(L3)`
CMD: `RUN_ACCEPTANCE(L4) -> [WAITING_FOR_L4_REVIEW] -> REVIEW_ACCEPTANCE(L4)`

### åˆ†å±‚éªŒæ”¶ç‰¹ç‚¹

| å±‚çº§ | éªŒæ”¶å¯¹è±¡ | è®¾è®¡è€… | å®ç°è€… | è¿è¡Œè€… | å®¡æŸ¥è€… |
|------|----------|--------|--------|--------|--------|
| **L1** | å•å…ƒ/å‡½æ•° | Tester | TestWorker | Worker | Oracle |
| **L2** | æ¨¡å— | Tester | TestWorker | Worker | Oracle |
| **L3** | åŠŸèƒ½ | Tester | TestWorker | Worker | Analyst + Oracle |
| **L4** | ç³»ç»Ÿ | Tester | TestWorker | Worker | Prometheus + Analyst + Oracle |

### å…³é”®åŸåˆ™

- **Testerè®¾è®¡**: åŸºäºdesign.mdè®¾è®¡L1-L4éªŒæ”¶æµ‹è¯•
- **TestWorkerå®ç°**: å®ç°éªŒæ”¶æµ‹è¯•ä»£ç 
- **Workerè¿è¡Œ**: åªè¿è¡Œæµ‹è¯•ï¼Œä¸åˆ›å»º/ä¿®æ”¹æµ‹è¯•
- **å…ˆä½åé«˜**: å¿…é¡»é€šè¿‡L1æ‰èƒ½è¿›è¡ŒL2ï¼Œä»¥æ­¤ç±»æ¨
- **æ¯å±‚å®¡æŸ¥**: æ¯å±‚é€šè¿‡åå¿…é¡»å®¡æŸ¥
- **æµ‹è¯•å……åˆ†æ€§**: æµ‹è¯•ä¸å……åˆ†æ—¶ï¼ŒWorkerä¸­æ–­è¯¢é—®ç”¨æˆ·

ğŸ‘‰ [åˆ†å±‚éªŒæ”¶æ ‡å‡†è¯¦æƒ…](../05_constraints/acceptance_criteria.md)

---

## å®¡æŸ¥å¾ªç¯

```
Prometheusè®¾è®¡ â†’ Skepticå®¡æŸ¥ â†’ Prometheuså›å¤ â†’ ...
```

**ç»ˆæ­¢æ¡ä»¶**:
- æ­£å¸¸: è®¾è®¡å®Œå–„
- å¼‚å¸¸: 3æ¬¡æ— æ³•å›å¤/åƒµå±€/éœ€ç”¨æˆ·å†³ç­–

---

## è·¨æ¨¡å—ä¾èµ–å¤„ç†

### åŸåˆ™

Worker **åªä¿®æ”¹å½“å‰ç›®å½•çš„ä»£ç **ï¼Œä¸ç›´æ¥ä¿®æ”¹å…¶ä»–ç›®å½•çš„å®ç°æˆ–è®¾è®¡å†…å®¹ã€‚

è·¨ç›®å½•åä½œä»…å…è®¸å¯¹ç›®æ ‡ç›®å½•çš„ `design.md` åšä¸€ç§å˜æ›´ï¼š**è¿½åŠ â€œå¾…å¤„ç†å˜æ›´â€æ¡ç›®**ï¼ˆä¸å¾—æ”¹åŠ¨å…¶ä»–ç« èŠ‚ã€ä¸å¾—é‡å†™æ—¢æœ‰è®¾è®¡ï¼‰ã€‚

### å¤„ç†æµç¨‹

```
Worker A å¤„ç† Dir A æ—¶å‘ç°éœ€è¦ä¿®æ”¹ Dir B
    â†“
Worker A åœ¨ Dir B çš„ design.md ä¸­**ä»…è¿½åŠ **â€œå¾…å¤„ç†å˜æ›´â€æ¡ç›®
    â†“
Worker A é€šçŸ¥ Supervisor
    â†“
Supervisor æ£€æŸ¥ Dir B çŠ¶æ€
    â”œâ”€ Dir B å·²æœ‰ Worker â†’ é€šçŸ¥ç°æœ‰ Worker
    â””â”€ Dir B æ—  Worker â†’ åˆ›å»º Worker B
    â†“
Worker A æ ‡è®° [DIR_WAITING_DEP] å¹¶ç­‰å¾…
    â†“
Worker B å®Œæˆ Dir B çš„ä¿®æ”¹
    â†“
Supervisor é€šçŸ¥ Worker A ç»§ç»­
    â†“
Worker A å®Œæˆ Dir A
```

### å¾…å¤„ç†å˜æ›´æ ‡è®°æ ¼å¼

åœ¨ç›®æ ‡ç›®å½•çš„ design.md ä¸­æ·»åŠ ï¼š

```markdown
## å¾…å¤„ç†å˜æ›´

### å˜æ›´ 1
- **æ¥æº**: Worker A (src/module_a/)
- **ç±»å‹**: æ¥å£å˜æ›´
- **æè¿°**: éœ€è¦æ·»åŠ  validate_input() å‡½æ•°
- **å½±å“**: å½±å“ module_a çš„æ•°æ®éªŒè¯
- **çŠ¶æ€**: [WAITING_FOR_WORKER]
- **åˆ›å»ºæ—¶é—´**: 2024-01-15 10:30

### å˜æ›´ 2
- **æ¥æº**: Worker C (src/module_c/)
- **ç±»å‹**: ä¾èµ–å˜æ›´
- **æè¿°**: éœ€è¦ä¿®æ”¹è¿”å›å€¼æ ¼å¼
- **çŠ¶æ€**: [WAITING_FOR_WORKER]
```

---

## å¹¶è¡Œæ‰§è¡Œç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šç®€å•å¹¶è¡Œ

```
src/
â”œâ”€â”€ module_a/design.md
â”œâ”€â”€ module_b/design.md
â””â”€â”€ module_c/design.md
```

**æ‰§è¡Œ**ï¼š
- ä¸‰ä¸ªç›®å½•æ·±åº¦ç›¸åŒï¼ˆå‡è®¾éƒ½æ˜¯æ·±åº¦ 2ï¼‰
- å¯åŠ¨ Worker Aã€Worker Bã€Worker C å¹¶è¡Œæ‰§è¡Œ
- æ— ä¾èµ–å…³ç³»ï¼Œå„è‡ªç‹¬ç«‹å®Œæˆ

### ç¤ºä¾‹ 2ï¼šä¾èµ–é“¾

```
src/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ utils/design.md      (æ·±åº¦ 3)
â”‚   â””â”€â”€ design.md            (æ·±åº¦ 2)
â””â”€â”€ api/
    â””â”€â”€ design.md            (æ·±åº¦ 2, ä¾èµ– core)
```

**æ‰§è¡Œ**ï¼š
1. **ç¬¬ä¸€æ‰¹**ï¼ˆæ·±åº¦ 3ï¼‰ï¼šWorker-1 å¤„ç† `core/utils/`
2. **ç¬¬äºŒæ‰¹**ï¼ˆæ·±åº¦ 2ï¼‰ï¼š
   - Worker-2 å¤„ç† `core/`ï¼ˆç­‰å¾… Worker-1ï¼‰
   - Worker-3 å¤„ç† `api/`ï¼ˆç­‰å¾… Worker-2ï¼‰

### ç¤ºä¾‹ 3ï¼šå¤æ‚ä¾èµ–ç½‘ç»œ

```
src/
â”œâ”€â”€ shared/design.md         (æ·±åº¦ 2)
â”œâ”€â”€ core/design.md           (æ·±åº¦ 2, ä¾èµ– shared)
â”œâ”€â”€ api/design.md            (æ·±åº¦ 2, ä¾èµ– core)
â””â”€â”€ web/design.md            (æ·±åº¦ 2, ä¾èµ– core)
```

**æ‰§è¡Œ**ï¼š
1. **ç¬¬ä¸€æ‰¹**ï¼šWorker-1 å¤„ç† `shared/`
2. **ç¬¬äºŒæ‰¹**ï¼šWorker-2 å¤„ç† `core/`ï¼ˆç­‰å¾… Worker-1ï¼‰
3. **ç¬¬ä¸‰æ‰¹**ï¼ˆå¹¶è¡Œï¼‰ï¼š
   - Worker-3 å¤„ç† `api/`ï¼ˆç­‰å¾… Worker-2ï¼‰
   - Worker-4 å¤„ç† `web/`ï¼ˆç­‰å¾… Worker-2ï¼‰

---

## çº¦æŸ

- å¿…é¡»éµå¾ªæ‰€æœ‰é˜¶æ®µ
- å¿…é¡»é€šè¿‡å®¡æŸ¥
- ä¸‰é”™å³åœé€‚ç”¨
- æ–‡æ¡£å¿…é¡»åŒæ­¥
- TDDæ¨¡å¼ä¸‹æµ‹è¯•ç”¨ä¾‹å¿…é¡»äººå·¥å®¡æ ¸
- **Worker ä¸è·¨è¶Š design.md è¾¹ç•Œä¿®æ”¹ä»£ç **
- **å¿…é¡»ç­‰å¾…ä¾èµ–ç›®å½•å®Œæˆåæ‰èƒ½ç»§ç»­**
- **åŒæ·±åº¦æ— ä¾èµ–ç›®å½•æ‰èƒ½å¹¶è¡Œ**
