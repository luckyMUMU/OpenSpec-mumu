# 安全与供应链红线

> **版本**: v1.4.0  
> **更新日期**: 2026-02-09

---

## 目的

本文件定义在 AI 协作编码中必须严格遵守的**安全红线**与**供应链治理要求**，用于降低“可用但不安全”的产出风险。

---

## 密钥与敏感信息（Secrets）

- 禁止将密钥、Token、证书、私钥、数据库口令写入代码库（含示例/注释/日志）
- 禁止在日志或错误信息中输出敏感信息（应脱敏或仅输出标识符）
- 禁止在调试中临时关闭脱敏逻辑后提交

---

## 鉴权与权限（AuthN/AuthZ）

- 禁止新增任何“绕过鉴权/授权”的快捷路径（例如本地开关、特定用户白名单）
- 涉及权限边界的变更必须升级到深度路径，并补齐对应验收用例
- 任何权限变更必须明确：主体、资源、动作、条件与默认拒绝策略

---

## 输入校验与注入防护（Validation/Injection）

- 外部输入必须在边界处校验（API 入参、消息队列、文件输入、Webhook）
- 禁止拼接不受控输入进入 SQL/命令/模板/正则等危险上下文
- 禁止通过“吞异常”来隐藏验证失败

---

## 传输安全（TLS/Network）

- 禁止关闭 TLS 校验（例如跳过证书校验、降级为 HTTP）
- 禁止将内部调试端点暴露到公网
- 变更外部网络调用必须明确：超时、重试、幂等、限流与降级策略

---

## 依赖与供应链（Dependencies/Supply Chain）

- 禁止在快速路径中新增依赖或升级核心依赖版本（必须升级到深度路径）
- 新增依赖必须说明：用途、替代方案、维护状态、许可证、引入风险
- 必须保持锁文件一致性（如存在 lockfile，不允许随意删除/重写）

---

## 数据与隐私（Data/Privacy）

- 禁止将个人敏感信息（PII）写入日志、测试样例、示例数据（除非已脱敏且有明确授权）
- 数据导出/调试脚本必须默认安全（最小数据量、最小权限、默认脱敏）

---

## 许可证与版权（License/Copyright）

- 禁止直接粘贴来源不明的大段第三方代码
- 引入参考实现时必须确认许可证兼容；必要时在 ADR/文档中记录来源与约束

---

## 自动化检查建议（可选）

建议在 CI 中加入以下检查（项目按需选用）：
- Secret scanning（密钥泄露扫描）
- Dependency audit（依赖漏洞与许可证审计）
- SAST（静态安全分析）
