# å®ç°è®¾è®¡æ¨¡æ¿ (L3: æŠ€æœ¯è§„æ ¼)

**å±‚çº§**: L3 - æŠ€æœ¯è§„æ ¼  
**ä½ç½®**: `src/**/design.md` æˆ– `docs/03_technical_spec/[module].md`  
**åˆ›å»ºè€…**: Oracle  
**è§„èŒƒ**: å°†L2ä¼ªä»£ç æ˜ å°„ä¸ºå…·ä½“æŠ€æœ¯å®ç°

---

## æ–‡ä»¶ç»“æ„

```markdown
# [æ¨¡å—] å®ç°è®¾è®¡

## 1. æŠ€æœ¯é€‰å‹
| ç»„ä»¶ | é€‰æ‹© | ç‰ˆæœ¬ | ç†ç”± |
|------|------|------|------|
| è¯­è¨€ | [è¯­è¨€] | [ç‰ˆæœ¬] | [ç†ç”±] |
| æ¡†æ¶ | [æ¡†æ¶] | [ç‰ˆæœ¬] | [ç†ç”±] |
| å­˜å‚¨ | [æ•°æ®åº“] | [ç‰ˆæœ¬] | [ç†ç”±] |
| ç¼“å­˜ | [ç¼“å­˜] | [ç‰ˆæœ¬] | [ç†ç”±] |

## 2. L2â†’L3 æ˜ å°„
åŸºäº: [L2é€»è¾‘è®¾è®¡æ–‡æ¡£é“¾æ¥]

| L2 åŸå­æ“ä½œ/ç‰‡æ®µ | L3 å®ç° | æŠ€æœ¯ç»†èŠ‚ |
|-----------|---------|----------|
| `VALIDATE_INPUT` | `InputValidator.validate()` | ä½¿ç”¨ Joi/Yup éªŒè¯ |
| `PROCESS_TYPE_A` | `TypeAProcessor.process()` | å¼‚æ­¥å¤„ç†ï¼Œçº¿ç¨‹æ±  |
| `PREPROCESS_DATA` | `DataTransformer.normalize()` | æ•°æ®æ¸…æ´—é€»è¾‘ |

## 3. é¢†åŸŸæ¨¡å‹

### å®ä½“å®šä¹‰
| å®ä½“ | å±æ€§ | ç±»å‹ | çº¦æŸ |
|------|------|------|------|
| [Entity] | [field] | [type] | [constraint] |

### ç±»/æ¥å£å®šä¹‰
```[language]
interface [Name] {
    [returnType] [method]([params]);
}

class [ClassName] implements [Interface] {
    // å®ç°L2çš„æŸä¸ªåŸå­æ“ä½œ
}
```

## 4. æ¥å£å¥‘çº¦

### è¾“å…¥
| å‚æ•° | ç±»å‹ | å¿…å¡« | éªŒè¯è§„åˆ™ | è¯´æ˜ |
|------|------|------|----------|------|
| [param] | [type] | [Y/N] | [rule] | [desc] |

### è¾“å‡º
| è¿”å› | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| [return] | [type] | [desc] |

### å¼‚å¸¸
| ç±»å‹ | è§¦å‘æ¡ä»¶ | å¤„ç† | HTTPç  |
|------|----------|------|--------|
| [Type] | [condition] | [handle] | [code] |

## 5. æ•°æ®æ¨¡å‹

### æ•°æ®åº“è¡¨
| è¡¨å | å­—æ®µ | ç±»å‹ | ç´¢å¼• | è¯´æ˜ |
|------|------|------|------|------|
| [table] | [field] | [type] | [index] | [desc] |

### API å®šä¹‰
```yaml
# OpenAPI/Swagger ç‰‡æ®µ
paths:
  /api/[endpoint]:
    [method]:
      parameters:
        - name: [param]
          type: [type]
      responses:
        [code]:
          description: [desc]
```

## 6. ä»»åŠ¡æ¸…å•
- [ ] [ä»»åŠ¡1: å¯¹åº”L2çš„æŸä¸ªåŸå­æ“ä½œ]
- [ ] [ä»»åŠ¡2]
- [ ] [ä»»åŠ¡3]

## 7. æµ‹è¯•ç­–ç•¥
- å•å…ƒæµ‹è¯•: [è¦†ç›–ç›®æ ‡ï¼Œå¯¹åº”L2é€»è¾‘åˆ†æ”¯]
- é›†æˆæµ‹è¯•: [åœºæ™¯]
- æ€§èƒ½æµ‹è¯•: [æŒ‡æ ‡]

## 8. åˆ†å±‚éªŒæ”¶æ¸…å•

**éªŒæ”¶æµç¨‹**: L1 â†’ L1å®¡æŸ¥ â†’ L2 â†’ L2å®¡æŸ¥ â†’ L3 â†’ L3å®¡æŸ¥ â†’ L4 â†’ L4å®¡æŸ¥

### L1 - å•å…ƒ/å‡½æ•°çº§åˆ«éªŒæ”¶

**éªŒæ”¶å‘½ä»¤**:
```bash
# æ ¹æ®æŠ€æœ¯æ ˆé€‰æ‹©
pytest tests/acceptance/l1/ -v --cov=src --cov-report=term-missing
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ‰€æœ‰å•å…ƒæµ‹è¯•é€šè¿‡
- [ ] ä»£ç è¦†ç›–ç‡ >= 80%
- [ ] æ— linté”™è¯¯
- [ ] æ— typeé”™è¯¯

**å®¡æŸ¥æ£€æŸ¥ç‚¹** (Oracleå®¡æŸ¥):
- [ ] æ¥å£å®ç°ç¬¦åˆæœ¬design.mdå®šä¹‰
- [ ] å¼‚å¸¸å¤„ç†å®Œæ•´
- [ ] æ—¥å¿—è®°å½•è§„èŒƒ
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–æ‰€æœ‰åˆ†æ”¯

### L2 - æ¨¡å—çº§åˆ«éªŒæ”¶

**éªŒæ”¶å‘½ä»¤**:
```bash
pytest tests/acceptance/l2/ -v
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ¨¡å—é›†æˆæµ‹è¯•é€šè¿‡
- [ ] æ¨¡å—é—´æ¥å£è°ƒç”¨æ­£å¸¸
- [ ] æ¨¡å—æ€§èƒ½è¾¾æ ‡

**å®¡æŸ¥æ£€æŸ¥ç‚¹** (Oracleå®¡æŸ¥):
- [ ] æ¨¡å—è®¾è®¡ç¬¦åˆæœ¬design.md
- [ ] æ¨¡å—é—´ä¾èµ–æ­£ç¡®
- [ ] æ¨¡å—è¾¹ç•Œæ¸…æ™°
- [ ] æ¥å£å¥‘çº¦æ»¡è¶³

### L3 - åŠŸèƒ½çº§åˆ«éªŒæ”¶

**éªŒæ”¶å‘½ä»¤**:
```bash
pytest tests/acceptance/l3/ -v
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] åŠŸèƒ½éªŒæ”¶æµ‹è¯•é€šè¿‡
- [ ] ç¬¦åˆFRDéœ€æ±‚
- [ ] ç”¨æˆ·åœºæ™¯è¦†ç›–

**å®¡æŸ¥æ£€æŸ¥ç‚¹** (Analyst + Oracleå®¡æŸ¥):
- [ ] åŠŸèƒ½å®ç°ç¬¦åˆæœ¬design.md
- [ ] ç¬¦åˆå¯¹åº”FRDéœ€æ±‚
- [ ] ç”¨æˆ·åœºæ™¯å®Œæ•´è¦†ç›–
- [ ] ä¸šåŠ¡è§„åˆ™æ­£ç¡®å®ç°

### L4 - ç³»ç»Ÿçº§åˆ«éªŒæ”¶

**éªŒæ”¶å‘½ä»¤**:
```bash
pytest tests/acceptance/l4/ -v
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] ç«¯åˆ°ç«¯æµ‹è¯•é€šè¿‡
- [ ] ç³»ç»Ÿæ€§èƒ½è¾¾æ ‡
- [ ] æ¶æ„çº¦æŸæ»¡è¶³

**å®¡æŸ¥æ£€æŸ¥ç‚¹** (Prometheus + Analyst + Oracleå®¡æŸ¥):
- [ ] ç¬¦åˆæ¶æ„è®¾è®¡æ–‡æ¡£
- [ ] ç¬¦åˆæœ¬design.mdæ•´ä½“è®¾è®¡
- [ ] ç³»ç»Ÿçº§çº¦æŸæ»¡è¶³
- [ ] æ€§èƒ½æŒ‡æ ‡è¾¾æ ‡
- [ ] å¯æ‰©å±•æ€§æ»¡è¶³

## 9. çŠ¶æ€
- `[è¿›è¡Œä¸­]` | [é˜¶æ®µ] | [æ—¥æœŸ]
- `[å·²å®Œæˆ]` | [é˜¶æ®µ] | [æ—¥æœŸ]
```

---

## L3å±‚çº¦æŸ

âœ… **å¿…é¡»**:
- æ˜ç¡®æŠ€æœ¯æ ˆï¼ˆè¯­è¨€ã€æ¡†æ¶ã€ç‰ˆæœ¬ï¼‰
- æ˜ å°„L2ä¼ªä»£ç åˆ°å…·ä½“å®ç°
- å®šä¹‰æ•°æ®æ¨¡å‹å’Œæ¥å£å¥‘çº¦
- åŒ…å«å¯æ‰§è¡Œçš„ä»»åŠ¡æ¸…å•

âŒ **ç¦æ­¢**:
- é‡å¤æè¿°L2å·²å®šä¹‰çš„é€»è¾‘
- å†™å…·ä½“ä¸šåŠ¡ä»£ç å®ç°
- é—æ¼ä¸L2çš„æ˜ å°„å…³ç³»

---

## L2â†’L3 æ˜ å°„ç¤ºä¾‹

### L2 ä¼ªä»£ç 
```pseudo
FUNCTION process_order(order):
    VALIDATE_ORDER order
    
    IF order.amount > 1000:
        REQUIRE_APPROVAL order
    END IF
    
    SAVE_ORDER order
    SEND_NOTIFICATION order.user_id
    
    RETURN order.id
END FUNCTION
```

### L3 å®ç°æ˜ å°„
| L2 åŸå­æ“ä½œ | L3 å®ç° | æŠ€æœ¯é€‰æ‹© |
|-------------|---------|----------|
| `VALIDATE_ORDER` | `OrderValidator.validate()` | Class-validator + DTO |
| `REQUIRE_APPROVAL` | `ApprovalService.request()` | çŠ¶æ€æœº + æ¶ˆæ¯é˜Ÿåˆ— |
| `SAVE_ORDER` | `OrderRepository.save()` | TypeORM + PostgreSQL |
| `SEND_NOTIFICATION` | `NotificationService.send()` | RabbitMQ + WebSocket |

---

## ä¸L2/L4çš„å…³ç³»

| å±‚çº§ | æ–‡ä»¶ | å†…å®¹ | åˆ›å»ºè€… |
|------|------|------|--------|
| L2 | `.md` | é€»è¾‘å·¥ä½œæµ | Prometheus |
| L3 | `design.md` | æŠ€æœ¯è§„æ ¼ | Oracle |
| L4 | `adr_*.md` | å†³ç­–èƒŒæ™¯ | Prometheus/Oracle |

ğŸ‘‰ L3 å¿…é¡»å¼•ç”¨å¯¹åº”çš„ L2 æ–‡æ¡£  
ğŸ‘‰ L3 çš„å…³é”®æŠ€æœ¯å†³ç­–å¯è®°å½•åˆ° L4 ADR
