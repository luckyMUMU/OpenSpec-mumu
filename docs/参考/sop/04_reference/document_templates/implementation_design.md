# 实现设计文档模板

**使用角色**: Oracle  
**文档位置**: `src/**/design.*`  
**编写原则**: 项目特定、实现导向、可操作

---

## 文档结构

```markdown
# [模块名称] 实现设计

## 1. 核心定义 (Stable)
## 2. 待实现方案 (In Progress)
## 3. 状态记录
```

---

## 完整模板

```markdown
# [模块名称] 实现设计

---

## 1. 核心定义 (Stable)

### 1.1 领域模型

#### 实体定义
- **[实体A]**
  - **属性**: [属性列表]
  - **职责**: [职责描述]
  - **约束**: [约束条件]

- **[实体B]**
  - **属性**: [属性列表]
  - **职责**: [职责描述]
  - **约束**: [约束条件]

#### 值对象定义
- **[值对象A]**: [定义和用途]
- **[值对象B]**: [定义和用途]

### 1.2 接口定义

#### 公开接口
```
interface [接口名称] {
    // [方法说明]
    [返回类型] [方法名]([参数列表]);
    
    // [方法说明]
    [返回类型] [方法名]([参数列表]);
}
```

#### 内部接口
```
interface [内部接口名称] {
    // [方法说明]
    [返回类型] [方法名]([参数列表]);
}
```

### 1.3 依赖关系

```
[本模块]
    ├── [依赖模块A]
    ├── [依赖模块B]
    └── [外部库/系统]
```

---

## 2. 待实现方案 (In Progress) 🟢

### 2.1 架构映射

**基于架构设计**: [链接到架构设计文档]

**实现选择**:
- **技术栈**: [选择的技术栈]
- **框架/库**: [使用的框架和库]
- **设计模式**: [采用的设计模式]

**适配调整**:
- [架构调整1]: [调整说明和理由]
- [架构调整2]: [调整说明和理由]

### 2.2 决策记录 (ADR)

#### 决策: [技术选型决策]

**背景**: [决策背景]

**选项对比**:

| 选项 | 优点 | 缺点 | 适用场景 |
|------|------|------|----------|
| 选项A | [优点] | [缺点] | [场景] |
| 选项B | [优点] | [缺点] | [场景] |

**决策**: 选择 [选项]

**理由**:
- [理由1]
- [理由2]

**风险与缓解**:
- **风险**: [风险描述] → **缓解**: [缓解措施]
- **风险**: [风险描述] → **缓解**: [缓解措施]

### 2.3 任务清单

#### Phase 1: 准备
- [ ] 1.1 环境准备
  - [ ] 安装依赖
  - [ ] 配置开发环境
- [ ] 1.2 代码检查点
  - [ ] 创建分支
  - [ ] 建立检查点

#### Phase 2: 核心实现
- [ ] 2.1 领域模型实现
  - [ ] 实现 [实体A]
  - [ ] 实现 [实体B]
- [ ] 2.2 接口实现
  - [ ] 实现 [接口方法1]
  - [ ] 实现 [接口方法2]
- [ ] 2.3 业务逻辑实现
  - [ ] 实现 [功能1]
  - [ ] 实现 [功能2]

#### Phase 3: 测试与质量
- [ ] 3.1 单元测试
  - [ ] 测试 [模块A]
  - [ ] 测试 [模块B]
- [ ] 3.2 集成测试
  - [ ] 测试集成场景1
  - [ ] 测试集成场景2
- [ ] 3.3 质量检查
  - [ ] 代码格式化
  - [ ] 静态分析

#### Phase 4: 文档与交付
- [ ] 4.1 代码注释
- [ ] 4.2 文档更新
- [ ] 4.3 代码审查

### 2.4 接口契约

#### 输入契约
```
{
    "field_a": "String, 必填, [说明]",
    "field_b": "Integer, 可选, [说明]"
}
```

#### 输出契约
```
{
    "result": "Object, [说明]",
    "status": "String, [说明]",
    "message": "String, [说明]"
}
```

#### 异常契约
| 异常类型 | 触发条件 | 处理方式 |
|----------|----------|----------|
| ValidationError | [条件] | [处理方式] |
| NotFoundError | [条件] | [处理方式] |

### 2.5 测试策略

#### 单元测试
- **覆盖目标**: [覆盖率目标]
- **测试重点**: [重点测试内容]
- **测试数据**: [测试数据准备]

#### 集成测试
- **测试场景**: [场景列表]
- **依赖处理**: [Mock/Stub 策略]

#### 边界测试
- [边界情况1]
- [边界情况2]

---

## 3. 状态记录

### 当前状态
- `[进行中]` | [当前阶段描述] | [日期]

### 历史记录
- `[已完成]` | [Phase 1 完成] | [日期]
- `[已完成]` | [Phase 2 完成] | [日期]
- `[已完成]` | [Phase 3 完成] | [日期]
- `[已完成]` | [Phase 4 完成] | [日期]

---

## 附录

### A. 参考资料
- [架构设计文档链接]
- [相关技术文档]
- [最佳实践参考]

### B. 术语表
- **[术语]**: [定义]

### C. 变更记录
| 日期 | 变更内容 | 变更人 |
|------|----------|--------|
| [日期] | [变更内容] | [角色] |
```

---

## 编写指南

### 2.1 架构映射编写要点
- 明确引用架构设计文档
- 说明技术选型的理由
- 记录必要的架构调整

### 2.2 任务清单编写要点
- 任务要具体可执行
- 按依赖关系排序
- 设置清晰的完成标准

### 2.3 接口契约编写要点
- 明确输入/输出格式
- 标注必填/可选字段
- 说明异常情况

---

## 质量检查清单

- [ ] 架构映射：与架构设计保持一致
- [ ] 技术选型：有明确的理由和风险评估
- [ ] 任务清单：具体、可执行、有优先级
- [ ] 接口契约：完整、清晰、可测试
- [ ] 测试策略：覆盖主流程和边界情况
- [ ] 状态记录：及时更新，反映真实进度

---

👉 [返回参考文档首页](../index.md)
