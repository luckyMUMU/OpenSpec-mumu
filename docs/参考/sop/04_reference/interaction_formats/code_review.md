---
version: v2.4.0
updated: 2026-02-22
---

# 代码审查格式

**使用**: sop-code-review ↔ sop-code-implementation

---

## sop-code-review 审查报告

```markdown
## 代码审查报告 - 第[N]轮

### Scope
- Diff: [link/摘要]
- Related Docs:
  - L2: [docs/02_logical_workflow/..]
  - L3: [src/**/design.md]
  - Tests: [CSV/测试设计/验收标准链接]

### 统计
- 严重: [N] 🔴
- 一般: [N] 🟡
- 建议: [N] 🟢

### 问题列表
| 级别 | 位置 | 设计依据 | 描述 | 建议 |
|------|------|----------|------|------|
| 🔴 | [path:line-range] | [design.md#章节] | [描述] | [建议] |

### 复核清单（摘要）
- [ ] 与 L2/L3 设计一致（接口/行为/错误处理）
- [ ] 变更范围合规（不跨 design.md 边界/跨目录依赖处理合规）
- [ ] 测试与验收满足（必要层级已补齐并通过）
- [ ] 安全与供应链红线满足（密钥/权限/输入校验/依赖治理等）
- [ ] 可维护性与可观测性满足（日志/错误/可读性/复杂度）
- [ ] 抽象层级一致（同一方法内调用同层级；对表操作优先复用 CRUD/Repository/DAO）

### 结论
- [ ] 需要修改（阻塞）
- [ ] 审查通过
- [ ] 陷入僵局（需用户决策）

规则：当轮次 >= 3 且仍存在 🔴 阻塞项时，必须选择“陷入僵局（需用户决策）”，并进入 `[USER_DECISION]`。
```

## sop-code-implementation 回复

```markdown
## 审查回复 - 第[N]轮

### 问题回复
| 问题 | 分析 | 修正 |
|------|------|------|
| [问题] | [分析] | [修正] |

### 变更汇总
| 文件 | 变更点 | 影响 |
|------|--------|------|
| [path] | [摘要] | [影响] |

### 结论
- [ ] 已解决，请求复查
- [ ] 存在争议，需讨论
```

---

## 僵局决策请求

```markdown
## 代码审查僵局 - 需用户决策

### 争议
- 焦点: [描述]
- 轮次: [N]

### 观点
**sop-code-review**: [观点]
**sop-code-implementation**: [观点]

### 选项
- A: [方案]
- B: [方案]
- C: [方案]

**请用户选择**
```

---

## 审查通过

```markdown
## 代码审查通过 ✅

### 统计
- 轮次: [N]
- 已解决: [N]
- 已采纳: [N]

### 下一步
进入 Diff 展示等待用户审批；随后 sop-document-sync 执行文档同步。
```

---

## 严重程度

| 级别 | 定义 | 处理 |
|------|------|------|
| 🔴 | 影响正确性/安全/边界/契约 | 必须解决 |
| 🟡 | 影响质量/维护/性能风险 | 建议解决 |
| 🟢 | 优化建议 | 可选采纳 |
