# 角色矩阵

## 角色总览

| 角色 | 层级 | 职责 | 权限 |
|------|------|------|------|
| Router | 规划 | 任务分诊 | 全局Read，分发指令 |
| Explorer | 规划 | 代码审计 | 仅Read |
| Analyst | 需求 | 需求分析，PRD生成 | 读写需求文档 |
| Prometheus | 设计 | 架构设计 | 读写架构文档 |
| Skeptic | 设计 | 架构审查 | 写入审查意见 |
| Oracle | 设计 | 实现设计 | 读写实现文档 |
| **Tester** | **设计** | **CSV测试用例唯一维护者** | **读写CSV** |
| Worker | 实现 | 编码实现 | Full-Write |
| **TestWorker** | **实现** | **测试代码维护者** | **读写测试代码，只读CSV** |
| Librarian | 监管 | 文档维护 | 仅文档文件 |
| Supervisor | 监管 | 进度监管，熔断决策 | 状态更新 |

---

## 权限矩阵

### 代码与需求

| 操作 | Router | Explorer | Analyst | Prometheus | Skeptic | Oracle | Tester | Librarian | Worker | TestWorker | Supervisor |
|------|--------|----------|---------|------------|---------|--------|--------|-----------|--------|------------|------------|
| 读代码 | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| 改代码 | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ✅ | ✅ | ❌ |
| 读需求 | ✅ | ✅ | ✅ | ✅ | ❌ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| 改需求 | ❌ | ❌ | ✅ | ❌ | ❌ | ❌ | ❌ | ✅ | ❌ | ❌ | ❌ |

### 架构与设计

| 操作 | Router | Explorer | Analyst | Prometheus | Skeptic | Oracle | Tester | Librarian | Worker | TestWorker | Supervisor |
|------|--------|----------|---------|------------|---------|--------|--------|-----------|--------|------------|------------|
| 读架构 | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| 改架构 | ❌ | ❌ | ❌ | ✅ | ❌ | ❌ | ❌ | ✅ | ❌ | ❌ | ❌ |
| 写审查 | ❌ | ❌ | ❌ | ❌ | ✅ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ |
| 读实现 | ✅ | ✅ | ❌ | ✅ | ❌ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| 改实现 | ❌ | ❌ | ❌ | ❌ | ❌ | ✅ | ❌ | ✅ | ❌ | ❌ | ❌ |

### 测试（关键隔离）

| 操作 | Router | Explorer | Analyst | Prometheus | Skeptic | Oracle | **Tester** | Librarian | Worker | **TestWorker** | Supervisor |
|------|--------|----------|---------|------------|---------|--------|------------|-----------|--------|----------------|------------|
| 读CSV测试用例 | ✅ | ✅ | ❌ | ✅ | ❌ | ✅ | ✅ | ✅ | ❌ | ✅ | ✅ |
| **改CSV测试用例** | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | **✅ 唯一** | ❌ | ❌ | **❌ 禁止** | ❌ |
| 读测试代码 | ✅ | ✅ | ❌ | ✅ | ❌ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| 改测试代码 | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ✅ | ❌ | ✅ | ❌ |
| 触发熔断 | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ✅ |

---

## 测试文件权限详解

### CSV测试用例文件

**位置**: `docs/03_technical_spec/test_cases/*.csv`

| 角色 | 权限 | 说明 |
|------|------|------|
| **Tester** | **读写** | **唯一维护者**，创建、修改、版本管理 |
| TestWorker | **只读** | 仅读取用例，禁止修改 |
| Worker | **禁止** | 不可访问 |
| 其他角色 | 只读 | 可查看，不可修改 |

### 测试代码文件

**位置**: `tests/*.test.[ext]`

| 角色 | 权限 | 说明 |
|------|------|------|
| **TestWorker** | **读写** | **唯一维护者**，编写、修改测试代码 |
| Tester | 只读 | 可查看测试代码实现 |
| Worker | 只读 | 了解测试，不修改 |
| 其他角色 | 只读 | 可查看 |

---

## 测试独立性原则

1. **Tester 独立**: 唯一维护CSV，不参考代码实现
2. **TestWorker 独立**: 只读CSV，基于用例写测试代码
3. **单向依赖**: 测试代码 → CSV → 设计文档，不反向依赖
4. **版本同步**: CSV版本变更时，TestWorker需同步更新测试代码

---

## 工作流

👉 [查看工作流详情](../03_workflow/index.md)

---

## 停止点

👉 [查看停止点定义](../03_workflow/index.md#停止点)
